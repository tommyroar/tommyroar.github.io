{"version":3,"file":"multiselect-item.js","sourceRoot":"","sources":["../../../../src/select/parts/multiselect-item.tsx"],"names":[],"mappings":"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","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useEffect, useRef, useState } from 'react';\n\nimport { useMergeRefs } from '@cloudscape-design/component-toolkit/internal';\n\nimport { getBaseProps } from '../../internal/base-component';\nimport CheckboxIcon from '../../internal/components/checkbox-icon';\nimport Option from '../../internal/components/option';\nimport { DropdownOption, OptionDefinition, OptionGroup } from '../../internal/components/option/interfaces';\nimport SelectableItem from '../../internal/components/selectable-item';\nimport useHiddenDescription from '../../internal/hooks/use-hidden-description';\nimport { MultiselectProps } from '../../multiselect/interfaces';\nimport Tooltip from '../../tooltip/internal.js';\nimport { ItemParentProps, ItemProps } from './item';\n\nimport styles from './styles.css.js';\ninterface MultiselectItemProps extends ItemProps<MultiselectProps.MultiselectOptionItemRenderer> {\n  indeterminate?: boolean;\n  parentProps?: MultiselectItemParentProps;\n}\n\nexport interface MultiselectItemParentProps extends ItemParentProps {\n  indeterminate: boolean;\n  highlighted: boolean;\n  selected: boolean;\n}\nconst toMultiselectOptionGroupItem = (\n  props: MultiselectItemParentProps\n): MultiselectProps.MultiselectOptionGroupItem => {\n  return {\n    type: 'group',\n    index: props.virtualIndex ?? props.index,\n    option: props.option.option as OptionGroup,\n    indeterminate: props.indeterminate ?? false,\n    selected: props.selected,\n    highlighted: props.highlighted,\n    disabled: props.disabled,\n  };\n};\nconst toMultiselectOptionItem = (props: {\n  index: number;\n  virtualIndex?: number;\n  option: DropdownOption;\n  disabled: boolean;\n  selected: boolean;\n  highlighted: boolean;\n  parentProps?: MultiselectItemParentProps;\n}): MultiselectProps.MultiselectOptionItem => {\n  return {\n    type: 'item',\n    index: props.virtualIndex ?? props.index,\n    option: props.option.option as OptionDefinition,\n    selected: props.selected,\n    highlighted: props.highlighted,\n    disabled: props.disabled,\n    parent: props.parentProps\n      ? toMultiselectOptionGroupItem({\n          index: props.parentProps?.index,\n          virtualIndex: props.parentProps?.virtualIndex,\n          option: props.parentProps?.option,\n          disabled: props.disabled,\n          highlighted: props.parentProps?.highlighted ?? false,\n          indeterminate: props.parentProps?.indeterminate ?? false,\n          selected: props.parentProps?.selected ?? false,\n        })\n      : null,\n  };\n};\n\nconst MultiSelectItem = (\n  {\n    index,\n    virtualIndex,\n    option,\n    highlighted,\n    selected,\n    filteringValue,\n    hasCheckbox,\n    virtualPosition,\n    padBottom,\n    isNextSelected,\n    isPreviousSelected,\n    indeterminate,\n    screenReaderContent,\n    ariaPosinset,\n    ariaSetsize,\n    highlightType,\n    withScrollbar,\n    sticky,\n    renderOption,\n    parentProps,\n    ...restProps\n  }: MultiselectItemProps,\n  ref: React.Ref<HTMLDivElement>\n) => {\n  const baseProps = getBaseProps(restProps);\n\n  const isParent = option.type === 'parent';\n  const isChild = option.type === 'child';\n  const isSelectAll = option.type === 'select-all';\n  const wrappedOption: OptionDefinition = option.option;\n  const disabled = option.disabled || wrappedOption.disabled;\n  const disabledReason =\n    disabled && (option.disabledReason || wrappedOption.disabledReason)\n      ? option.disabledReason || wrappedOption.disabledReason\n      : '';\n  const isDisabledWithReason = !!disabledReason;\n  const internalRef = useRef<HTMLDivElement>(null);\n  const className = styles.item;\n\n  const { descriptionId, descriptionEl } = useHiddenDescription(disabledReason);\n\n  const [canShowTooltip, setCanShowTooltip] = useState(true);\n  useEffect(() => setCanShowTooltip(true), [highlighted]);\n\n  const getMultiselectItemProps = (option: DropdownOption): MultiselectProps.MultiselectItem => {\n    if (option.type === 'parent') {\n      return toMultiselectOptionGroupItem({\n        option: option,\n        index: index,\n        virtualIndex: virtualIndex,\n        disabled: !!disabled,\n        highlighted: !!highlighted,\n        selected: !!selected,\n        indeterminate: indeterminate ?? false,\n      });\n    } else if (option.type === 'select-all') {\n      return {\n        type: 'select-all',\n        option: option.option as OptionDefinition,\n        indeterminate: indeterminate ?? false,\n        selected: !!selected,\n        highlighted: !!highlighted,\n      };\n    } else {\n      return toMultiselectOptionItem({\n        option: option,\n        index: index,\n        virtualIndex: virtualIndex,\n        disabled: !!disabled,\n        highlighted: !!highlighted,\n        selected: !!selected,\n        parentProps: parentProps,\n      });\n    }\n  };\n\n  const renderOptionWrapper = (option: DropdownOption) => {\n    if (!renderOption) {\n      return null;\n    }\n\n    return renderOption({ item: getMultiselectItemProps(option), filterText: filteringValue });\n  };\n\n  const renderResult = renderOptionWrapper(option);\n\n  return (\n    <SelectableItem\n      disableContentStyling={!!renderResult}\n      ariaSelected={isParent && indeterminate ? undefined : Boolean(selected)}\n      ariaChecked={isParent && indeterminate ? 'mixed' : Boolean(selected)}\n      selected={selected}\n      isNextSelected={isNextSelected}\n      isPreviousSelected={isPreviousSelected}\n      highlighted={highlighted}\n      disabled={disabled}\n      isParent={isParent}\n      isChild={isChild}\n      isSelectAll={isSelectAll}\n      highlightType={highlightType}\n      ref={useMergeRefs(ref, internalRef)}\n      virtualPosition={virtualPosition}\n      padBottom={padBottom}\n      useInteractiveGroups={true}\n      screenReaderContent={screenReaderContent}\n      ariaPosinset={ariaPosinset}\n      ariaSetsize={ariaSetsize}\n      ariaDescribedby={isDisabledWithReason ? descriptionId : ''}\n      value={option.option.value}\n      afterHeader={option.afterHeader}\n      withScrollbar={withScrollbar}\n      sticky={sticky}\n      {...baseProps}\n    >\n      <div className={className}>\n        {!renderResult && hasCheckbox && (\n          <div className={styles.checkbox}>\n            <CheckboxIcon\n              checked={selected}\n              indeterminate={(isParent || isSelectAll) && indeterminate}\n              disabled={disabled}\n            />\n          </div>\n        )}\n        <Option\n          customContent={renderResult}\n          option={{ ...wrappedOption, disabled }}\n          highlightedOption={highlighted}\n          selectedOption={selected}\n          highlightText={filteringValue}\n          isGroupOption={isParent}\n        />\n      </div>\n      {!renderResult && isDisabledWithReason && (\n        <>\n          {descriptionEl}\n          {highlighted && canShowTooltip && (\n            <Tooltip\n              className={styles['disabled-reason-tooltip']}\n              getTrack={() => internalRef.current}\n              content={disabledReason!}\n              position=\"right\"\n              onEscape={() => setCanShowTooltip(false)}\n            />\n          )}\n        </>\n      )}\n    </SelectableItem>\n  );\n};\n\nexport default React.memo(React.forwardRef(MultiSelectItem));\n"]}