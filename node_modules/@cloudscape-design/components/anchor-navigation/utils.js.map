{"version":3,"file":"utils.js","sourceRoot":"","sources":["../../../src/anchor-navigation/utils.tsx"],"names":[],"mappings":"AAAA,qEAAqE;AACrE,sCAAsC;AACtC,OAAO,KAAK,MAAM,OAAO,CAAC;AAC1B,OAAO,IAAI,MAAM,MAAM,CAAC;AAExB,OAAO,EAAE,UAAU,EAAE,MAAM,eAAe,CAAC;AAG3C,OAAO,MAAM,MAAM,iBAAiB,CAAC;AACrC,OAAO,eAAe,MAAM,8BAA8B,CAAC;AAQ3D,MAAM,iBAAiB,GAAG,CACxB,KAAqC,EACrC,YAAoB,EACpB,YAAoB,EACY,EAAE;IAClC,MAAM,UAAU,GAAmC,EAAE,CAAC;IACtD,IAAI,SAAS,GAAG,YAAY,GAAG,CAAC,CAAC;IAEjC,OAAO,SAAS,GAAG,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,SAAS,CAAC,CAAC,KAAK,GAAG,YAAY,EAAE,CAAC;QACzE,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;QAClC,SAAS,EAAE,CAAC;IACd,CAAC;IAED,OAAO,UAAU,CAAC;AACpB,CAAC,CAAC;AAOF,MAAM,gBAAgB,GAAG,CACvB,WAAyC,EACzC,KAAa,EACb,UAA0C,EAC1C,WAAoC,EACpC,OAAsB,EACtB,EAAE;IACF,MAAM,SAAS,GAAsB,EAAE,CAAC;IACxC,MAAM,WAAW,GAAG,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC;IAC1C,MAAM,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,EAAE,eAAe,CAAC,aAAa,CAAC,CAAC,CAAC;IAEhF,IAAI,WAAW,EAAE,CAAC;QAChB,WAAW,CAAC,IAAI,CAAC;YACf,KAAK,EAAE,UAAU;YACjB,UAAU,EAAE,SAAS;YACrB,UAAU,EAAE,KAAK,GAAG,CAAC;SACtB,CAAC,CAAC;IACL,CAAC;IAED,OAAO,CACL,oBAAC,UAAU,IACT,QAAQ,EAAE,OAAO,CAAC,eAAe,EACjC,QAAQ,EAAE,WAAW,CAAC,IAAI,KAAK,OAAO,CAAC,iBAAiB,EACxD,GAAG,EAAE,KAAK,EACV,KAAK,EAAE,KAAK,EACZ,MAAM,EAAE,WAAW,IAElB,WAAW,IAAI,4BAAI,SAAS,EAAE,WAAW,IAAG,SAAS,CAAM,CACjD,CACd,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,gBAAgB,GAAG,CACvB,KAAqC,EACrC,UAAkB,EAClB,UAA6B,EAC7B,WAAoC,EACpC,OAAsB,EACtB,EAAE;IACF,IAAI,YAAY,GAAG,CAAC,CAAC;IACrB,OAAO,YAAY,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC;QACnC,MAAM,WAAW,GAAG,KAAK,CAAC,YAAY,CAAC,CAAC;QACxC,MAAM,UAAU,GAAG,iBAAiB,CAAC,KAAK,EAAE,YAAY,EAAE,WAAW,CAAC,KAAK,CAAC,CAAC;QAE7E,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,UAAU,GAAG,YAAY,EAAE,UAAU,EAAE,WAAW,EAAE,OAAO,CAAC,CAAC,CAAC;QAC5G,YAAY,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC;IACxC,CAAC;AACH,CAAC,CAAC;AAEF,sHAAsH;AACtH,MAAM,CAAC,MAAM,mBAAmB,GAAG,CAAC,KAAqC,EAAE,OAAsB,EAAmB,EAAE;IACpH,MAAM,QAAQ,GAAsB,EAAE,CAAC;IACvC,MAAM,WAAW,GAA4B,EAAE,CAAC;IAEhD,WAAW,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,UAAU,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC,EAAE,CAAC,CAAC;IAEjE,OAAO,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;QAC9B,MAAM,WAAW,GAAG,WAAW,CAAC,KAAK,EAAG,CAAC;QACzC,gBAAgB,CAAC,WAAW,CAAC,KAAK,EAAE,WAAW,CAAC,UAAU,EAAE,WAAW,CAAC,UAAU,EAAE,WAAW,EAAE,OAAO,CAAC,CAAC;IAC5G,CAAC;IAED,OAAO,QAAQ,CAAC;AAClB,CAAC,CAAC","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React from 'react';\nimport clsx from 'clsx';\n\nimport { AnchorItem } from './anchor-item';\nimport { AnchorNavigationProps } from './interfaces';\n\nimport styles from './styles.css.js';\nimport testUtilsStyles from './test-classes/styles.css.js';\n\ninterface AnchorRenderQueueItem {\n  items: AnchorNavigationProps.Anchor[];\n  parentList: React.ReactNode[];\n  startIndex: number;\n}\n\nconst collectChildItems = (\n  items: AnchorNavigationProps.Anchor[],\n  currentIndex: number,\n  currentLevel: number\n): AnchorNavigationProps.Anchor[] => {\n  const childItems: AnchorNavigationProps.Anchor[] = [];\n  let nextIndex = currentIndex + 1;\n\n  while (nextIndex < items.length && items[nextIndex].level > currentLevel) {\n    childItems.push(items[nextIndex]);\n    nextIndex++;\n  }\n\n  return childItems;\n};\n\ninterface RenderContext {\n  onFollowHandler: (anchor: AnchorNavigationProps.Anchor, sourceEvent: React.SyntheticEvent | Event) => void;\n  currentActiveHref: string | undefined;\n}\n\nconst createAnchorItem = (\n  currentItem: AnchorNavigationProps.Anchor,\n  index: number,\n  childItems: AnchorNavigationProps.Anchor[],\n  renderQueue: AnchorRenderQueueItem[],\n  context: RenderContext\n) => {\n  const childList: React.ReactNode[] = [];\n  const hasChildren = childItems.length > 0;\n  const olClassNAme = clsx(styles['anchor-list'], testUtilsStyles['anchor-list']);\n\n  if (hasChildren) {\n    renderQueue.push({\n      items: childItems,\n      parentList: childList,\n      startIndex: index + 1,\n    });\n  }\n\n  return (\n    <AnchorItem\n      onFollow={context.onFollowHandler}\n      isActive={currentItem.href === context.currentActiveHref}\n      key={index}\n      index={index}\n      anchor={currentItem}\n    >\n      {hasChildren && <ol className={olClassNAme}>{childList}</ol>}\n    </AnchorItem>\n  );\n};\n\nconst processQueueItem = (\n  items: AnchorNavigationProps.Anchor[],\n  startIndex: number,\n  parentList: React.ReactNode[],\n  renderQueue: AnchorRenderQueueItem[],\n  context: RenderContext\n) => {\n  let currentIndex = 0;\n  while (currentIndex < items.length) {\n    const currentItem = items[currentIndex];\n    const childItems = collectChildItems(items, currentIndex, currentItem.level);\n\n    parentList.push(createAnchorItem(currentItem, startIndex + currentIndex, childItems, renderQueue, context));\n    currentIndex += childItems.length + 1;\n  }\n};\n\n// Perform a queue-based breadth-first traversal that groups child items under their parents based on level hierarchy.\nexport const renderNestedAnchors = (items: AnchorNavigationProps.Anchor[], context: RenderContext): React.ReactNode => {\n  const rootList: React.ReactNode[] = [];\n  const renderQueue: AnchorRenderQueueItem[] = [];\n\n  renderQueue.push({ items, parentList: rootList, startIndex: 0 });\n\n  while (renderQueue.length > 0) {\n    const currentItem = renderQueue.shift()!;\n    processQueueItem(currentItem.items, currentItem.startIndex, currentItem.parentList, renderQueue, context);\n  }\n\n  return rootList;\n};\n"]}