{"version":3,"file":"autosuggest-option.js","sourceRoot":"","sources":["../../../src/autosuggest/autosuggest-option.tsx"],"names":[],"mappings":"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","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React from 'react';\n\nimport { BaseComponentProps, getBaseProps } from '../internal/base-component';\nimport OptionComponent from '../internal/components/option';\nimport { OptionDefinition, OptionGroup } from '../internal/components/option/interfaces';\nimport { getTestOptionIndexes } from '../internal/components/options-list/utils/test-indexes';\nimport { HighlightType } from '../internal/components/options-list/utils/use-highlight-option';\nimport SelectableItem from '../internal/components/selectable-item';\nimport { AutosuggestItem, AutosuggestProps } from './interfaces';\n\nimport styles from './styles.css.js';\n\ninterface AutosuggestOptionProps extends BaseComponentProps {\n  index: number;\n  virtualIndex?: number;\n  nativeAttributes?: React.HTMLAttributes<HTMLDivElement>;\n  highlightText: string;\n  option: AutosuggestItem;\n  highlighted: boolean;\n  highlightType: HighlightType;\n  current: boolean;\n  virtualPosition?: number;\n  padBottom?: boolean;\n  screenReaderContent?: string;\n  ariaSetsize?: number;\n  ariaPosinset?: number;\n  renderOption?: AutosuggestProps.ItemRenderer;\n  parentProps?: AutosuggestRenderItemParentProps;\n}\n\nexport interface AutosuggestRenderItemParentProps {\n  index: number;\n  virtualIndex?: number;\n  option: AutosuggestItem;\n  disabled: boolean;\n}\n\nconst toAutosuggestOptionGroupItem = (\n  props: AutosuggestRenderItemParentProps\n): AutosuggestProps.OptionGroupRenderItem => {\n  return {\n    type: 'group',\n    index: props.virtualIndex ?? props.index,\n    option: props.option.option as OptionGroup,\n    disabled: props.disabled,\n  };\n};\n\nconst toAutosuggestOptionItem = (props: {\n  index: number;\n  virtualIndex?: number;\n  option: AutosuggestItem;\n  disabled: boolean;\n  selected: boolean;\n  highlighted: boolean;\n  parentProps?: AutosuggestRenderItemParentProps;\n}): AutosuggestProps.OptionRenderItem => {\n  return {\n    type: 'item',\n    index: props.virtualIndex ?? props.index,\n    option: props.option.option as OptionDefinition,\n    selected: props.selected,\n    highlighted: props.highlighted,\n    disabled: props.disabled,\n    parent: props.parentProps\n      ? toAutosuggestOptionGroupItem({\n          index: props.parentProps.index,\n          virtualIndex: props.parentProps.virtualIndex,\n          option: props.parentProps.option,\n          disabled: props.disabled,\n        })\n      : null,\n  };\n};\n\nconst toAutosuggestUseEnteredItem = (props: {\n  option: AutosuggestItem;\n  highlighted: boolean;\n}): AutosuggestProps.EnteredTextRenderItem => {\n  return {\n    type: 'entered-text',\n    option: props.option.option as OptionDefinition,\n    highlighted: props.highlighted,\n  };\n};\n\nconst AutosuggestOption = (\n  {\n    index,\n    virtualIndex,\n    nativeAttributes = {},\n    highlightText,\n    option,\n    highlighted,\n    highlightType,\n    current,\n    virtualPosition,\n    padBottom,\n    screenReaderContent,\n    ariaSetsize,\n    ariaPosinset,\n    renderOption,\n    parentProps,\n    ...rest\n  }: AutosuggestOptionProps,\n  ref: React.Ref<HTMLDivElement>\n) => {\n  const baseProps = getBaseProps(rest);\n  const useEntered = 'type' in option && option.type === 'use-entered';\n  const isParent = 'type' in option && option.type === 'parent';\n  const isChild = 'type' in option && option.type === 'child';\n  const { throughIndex, inGroupIndex, groupIndex } = getTestOptionIndexes(option) || {};\n\n  let optionContent;\n  if (useEntered) {\n    optionContent = option.label;\n    // we don't want fancy generated content for screenreader for the \"Use...\" option,\n    // just the visible text is fine\n    screenReaderContent = undefined;\n  } else if (isParent) {\n    optionContent = option.label;\n  } else {\n    const a11yProperties: AutosuggestOptionProps['nativeAttributes'] = {};\n    if (nativeAttributes['aria-label']) {\n      a11yProperties['aria-label'] = nativeAttributes['aria-label'];\n    }\n\n    optionContent = (\n      <div {...a11yProperties}>\n        <OptionComponent option={option} highlightedOption={highlighted} highlightText={highlightText} />\n      </div>\n    );\n  }\n\n  const getAutosuggestItemProps = (option: AutosuggestItem) => {\n    if (option.type === 'parent') {\n      return toAutosuggestOptionGroupItem({\n        option: option,\n        index: index,\n        virtualIndex: virtualIndex,\n        disabled: !!option.disabled,\n      });\n    } else if (option.type === 'use-entered') {\n      return toAutosuggestUseEnteredItem({\n        option: option,\n        highlighted: highlighted,\n      });\n    } else {\n      return toAutosuggestOptionItem({\n        option: option,\n        index: index,\n        virtualIndex: virtualIndex,\n        disabled: !!option.disabled,\n        highlighted: highlighted,\n        selected: current,\n        parentProps: parentProps,\n      });\n    }\n  };\n\n  const renderOptionWrapper = (option: AutosuggestItem) => {\n    if (!renderOption) {\n      return null;\n    }\n\n    return renderOption({ item: getAutosuggestItemProps(option), filterText: highlightText });\n  };\n  const renderResult = renderOptionWrapper(option);\n\n  return (\n    <SelectableItem\n      {...baseProps}\n      disableContentStyling={!!renderResult}\n      className={styles.option}\n      ariaSelected={current}\n      highlighted={highlighted}\n      disabled={option.disabled}\n      hasBackground={useEntered}\n      isParent={isParent}\n      isChild={isChild}\n      virtualPosition={virtualPosition}\n      data-test-index={throughIndex}\n      data-in-group-index={inGroupIndex}\n      data-group-index={groupIndex}\n      ref={ref}\n      padBottom={padBottom}\n      screenReaderContent={screenReaderContent}\n      ariaSetsize={ariaSetsize}\n      ariaPosinset={ariaPosinset}\n      highlightType={highlightType.type}\n      value={option.value}\n    >\n      {!renderResult ? optionContent : renderResult}\n    </SelectableItem>\n  );\n};\n\nexport default React.memo(React.forwardRef(AutosuggestOption));\n"]}