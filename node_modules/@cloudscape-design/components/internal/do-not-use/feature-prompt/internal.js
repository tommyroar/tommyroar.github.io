// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
// SPDX-License-Identifier: Apache-2.0
import React, { useImperativeHandle, useRef, useState } from 'react';
import { Portal } from '@cloudscape-design/component-toolkit/internal';
import Arrow from '../../../popover/arrow';
import PopoverBody from '../../../popover/body';
import PopoverContainer from '../../../popover/container';
import { getBaseProps } from '../../base-component';
import ResetContextsForModal from '../../context/reset-contexts-for-modal';
import { fireNonCancelableEvent } from '../../events';
import styles from './styles.css.js';
function InternalFeaturePrompt({ onShow, onDismiss, header, content, i18nStrings, size, position, getTrack, trackKey, __internalRootRef, ...restProps }, ref) {
    const baseProps = getBaseProps(restProps);
    const [show, setShow] = useState(false);
    const popoverBodyRef = useRef(null);
    useImperativeHandle(ref, () => ({
        dismiss: () => {
            setShow(false);
            fireNonCancelableEvent(onDismiss);
        },
        show: () => {
            setShow(true);
            fireNonCancelableEvent(onShow);
        },
    }));
    return (React.createElement("span", { ...baseProps, className: styles.root, ref: __internalRootRef }, show && (React.createElement(Portal, null,
        React.createElement(ResetContextsForModal, null,
            React.createElement(PopoverContainer, { size: size, fixedWidth: false, position: position, getTrack: getTrack, trackKey: trackKey, variant: "annotation", arrow: position => React.createElement(Arrow, { position: position, variant: "info" }), zIndex: 7000, renderWithPortal: true },
                React.createElement(PopoverBody, { ref: popoverBodyRef, dismissButton: true, dismissAriaLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.dismissAriaLabel, header: header, onDismiss: () => {
                        setShow(false);
                        fireNonCancelableEvent(onDismiss);
                    }, variant: "annotation", overflowVisible: "content", onBlur: event => {
                        var _a;
                        const relatedTarget = event.relatedTarget;
                        if (relatedTarget && ((_a = popoverBodyRef.current) === null || _a === void 0 ? void 0 : _a.contains(relatedTarget))) {
                            return;
                        }
                        setShow(false);
                        fireNonCancelableEvent(onDismiss);
                    } }, content)))))));
}
export default React.forwardRef(InternalFeaturePrompt);
//# sourceMappingURL=internal.js.map