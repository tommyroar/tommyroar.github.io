{"version":3,"file":"interactions-store.js","sourceRoot":"","sources":["../../../../src/area-chart/model/interactions-store.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport AsyncStore from '../async-store';\nimport { AreaChartProps } from '../interfaces';\nimport { ChartModel } from './index';\n\nconst initialState = Object.freeze({\n  highlightedX: null,\n  highlightedPoint: null,\n  highlightedSeries: null,\n  legendSeries: null,\n  isPopoverPinned: false,\n});\n\nexport default class InteractionsStore<T extends AreaChartProps.DataTypes> extends AsyncStore<\n  ChartModel.InteractionsState<T>\n> {\n  series: readonly AreaChartProps.Series<T>[];\n  plot: ChartModel.ComputedProps<T>['plot'];\n\n  constructor(series: readonly AreaChartProps.Series<T>[], plot: ChartModel.ComputedProps<T>['plot']) {\n    super(initialState);\n\n    this.series = series;\n    this.plot = plot;\n  }\n\n  highlightPoint(point: ChartModel.PlotPoint<T>) {\n    this.set(state => ({\n      ...state,\n      highlightedX: this.plot.xy[point.index.x],\n      highlightedPoint: point,\n      highlightedSeries: this.series[point.index.s],\n      legendSeries: this.series[point.index.s],\n    }));\n  }\n\n  highlightX(points: readonly ChartModel.PlotPoint<T>[]) {\n    this.set(state => ({\n      ...state,\n      highlightedX: points,\n      highlightedPoint: null,\n      highlightedSeries: null,\n      legendSeries: null,\n    }));\n  }\n\n  highlightFirstPoint() {\n    this.set(state => {\n      const series = state.legendSeries || state.highlightedSeries;\n      const firstSeriesPoint = series && this._getFirstSeriesPoint(series);\n      const point = state.highlightedPoint || firstSeriesPoint || this.plot.sx[0][0];\n      return {\n        ...state,\n        highlightedX: this.plot.xy[point.index.x],\n        highlightedPoint: point,\n        highlightedSeries: this.series[point.index.s],\n        legendSeries: this.series[point.index.s],\n      };\n    });\n  }\n\n  highlightSeries(s: null | AreaChartProps.Series<T>) {\n    this.set(state => ({\n      ...state,\n      highlightedSeries: s,\n      legendSeries: s,\n    }));\n  }\n\n  clearHighlight() {\n    this.set(state => ({\n      ...state,\n      highlightedX: null,\n      highlightedPoint: null,\n      highlightedSeries: null,\n    }));\n  }\n  clearHighlightedLegend() {\n    this.set(state => ({\n      ...state,\n      legendSeries: null,\n    }));\n  }\n\n  clearState() {\n    this.set(() => initialState);\n  }\n\n  pinPopover() {\n    this.set(state => ({ ...state, isPopoverPinned: true }));\n  }\n\n  unpinPopover() {\n    this.set(state => ({ ...state, isPopoverPinned: false }));\n  }\n\n  togglePopoverPin() {\n    this.set(state => ({ ...state, isPopoverPinned: !state.isPopoverPinned }));\n  }\n\n  _getFirstSeriesPoint(s: AreaChartProps.Series<T>): null | ChartModel.PlotPoint<T> {\n    const seriesIndex = this.series.indexOf(s);\n    const [firstSeriesPoint] = this.plot.sx[seriesIndex] || [];\n    return firstSeriesPoint || null;\n  }\n}\n"]}