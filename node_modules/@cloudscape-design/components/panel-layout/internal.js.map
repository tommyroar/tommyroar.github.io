{"version":3,"file":"internal.js","sourceRoot":"","sources":["../../../src/panel-layout/internal.tsx"],"names":[],"mappings":"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","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useEffect } from 'react';\nimport clsx from 'clsx';\n\nimport { useMergeRefs, useStableCallback } from '@cloudscape-design/component-toolkit/internal';\n\nimport { useResize } from '../app-layout/visual-refresh-toolbar/drawer/use-resize';\nimport { getBaseProps } from '../internal/base-component';\nimport PanelResizeHandle from '../internal/components/panel-resize-handle';\nimport { fireNonCancelableEvent } from '../internal/events';\nimport { InternalBaseComponentProps } from '../internal/hooks/use-base-component';\nimport { useControllable } from '../internal/hooks/use-controllable';\nimport { SomeRequired } from '../internal/types';\nimport useContainerWidth from '../internal/utils/use-container-width';\nimport { PanelLayoutProps } from './interfaces';\n\nimport styles from './styles.css.js';\nimport testStyles from './test-classes/styles.css.js';\n\nconst DEFAULT_PANEL_SIZE = 200;\n\ntype InternalPanelLayoutProps = SomeRequired<PanelLayoutProps, 'panelPosition' | 'resizable' | 'display'> &\n  InternalBaseComponentProps;\n\nconst InternalPanelLayout = React.forwardRef<PanelLayoutProps.Ref, InternalPanelLayoutProps>(\n  (\n    {\n      panelPosition,\n      panelContent,\n      mainContent,\n      defaultPanelSize,\n      panelSize: controlledPanelSize,\n      resizable,\n      onPanelResize,\n      onLayoutChange,\n      minPanelSize,\n      maxPanelSize,\n      i18nStrings,\n      display,\n      panelFocusable,\n      mainFocusable,\n      __internalRootRef,\n      ...props\n    },\n    ref\n  ) => {\n    const baseProps = getBaseProps(props);\n\n    const resizeHandleRef = React.useRef<HTMLDivElement>(null);\n    const panelRef = React.useRef<HTMLDivElement>(null);\n    const [containerWidth, rootRef] = useContainerWidth();\n\n    React.useImperativeHandle(\n      ref,\n      () => ({\n        focusResizeHandle() {\n          resizeHandleRef.current?.focus();\n        },\n      }),\n      []\n    );\n\n    const [panelSize = DEFAULT_PANEL_SIZE, setPanelSize] = useControllable(\n      controlledPanelSize,\n      onPanelResize,\n      defaultPanelSize ?? minPanelSize,\n      {\n        componentName: 'PanelLayout',\n        controlledProp: 'panelSize',\n        changeHandler: 'onPanelResize',\n      }\n    );\n\n    const actualMaxSize = Math.min(maxPanelSize ?? containerWidth, containerWidth);\n    const actualMinSize = minPanelSize ?? 0;\n    const actualPanelSize = Math.max(Math.min(panelSize, actualMaxSize), actualMinSize);\n\n    const stableLayoutChangeEvent = useStableCallback((details: PanelLayoutProps.PanelResizeDetail) =>\n      fireNonCancelableEvent(onLayoutChange, details)\n    );\n    useEffect(() => {\n      stableLayoutChangeEvent({ totalSize: containerWidth, panelSize: actualPanelSize });\n    }, [containerWidth, actualPanelSize, stableLayoutChangeEvent]);\n\n    const resizeHandlePosition = panelPosition === 'side-end' ? 'side' : panelPosition;\n    const resizeProps = useResize({\n      currentWidth: actualPanelSize,\n      minWidth: actualMinSize,\n      maxWidth: actualMaxSize,\n      panelRef: panelRef,\n      handleRef: resizeHandleRef,\n      position: resizeHandlePosition,\n      onResize: size => {\n        setPanelSize(size);\n        fireNonCancelableEvent(onPanelResize, { totalSize: containerWidth, panelSize: size });\n      },\n    });\n\n    const mergedRef = useMergeRefs(rootRef, __internalRootRef, ref);\n\n    const wrappedPanelContent = (\n      <div\n        className={clsx(styles['panel-content'], display !== 'main-only' && testStyles.panel)}\n        tabIndex={panelFocusable && 0}\n        role={panelFocusable && 'region'}\n        aria-label={panelFocusable?.ariaLabel}\n        aria-labelledby={panelFocusable?.ariaLabelledby}\n      >\n        {panelContent}\n      </div>\n    );\n    const wrappedMainContent = (\n      <div\n        className={clsx(styles.content, display !== 'panel-only' && testStyles.content)}\n        tabIndex={mainFocusable && 0}\n        role={mainFocusable && 'region'}\n        aria-label={mainFocusable?.ariaLabel}\n        aria-labelledby={mainFocusable?.ariaLabelledby}\n      >\n        {mainContent}\n      </div>\n    );\n    const handle = (\n      <div className={styles.handle}>\n        <PanelResizeHandle\n          ref={resizeHandleRef}\n          className={testStyles['resize-handle']}\n          position={resizeHandlePosition}\n          ariaLabel={i18nStrings?.resizeHandleAriaLabel}\n          tooltipText={i18nStrings?.resizeHandleTooltipText}\n          ariaValuenow={resizeProps.relativeSize}\n          onKeyDown={resizeProps.onKeyDown}\n          onDirectionClick={resizeProps.onDirectionClick}\n          onPointerDown={resizeProps.onPointerDown}\n        />\n      </div>\n    );\n\n    return (\n      <div\n        {...baseProps}\n        ref={mergedRef}\n        className={clsx(baseProps.className, styles.root, testStyles.root, styles[`display-${display}`])}\n      >\n        {panelPosition === 'side-end' && wrappedMainContent}\n        <div\n          className={clsx(styles.panel)}\n          ref={panelRef}\n          style={display === 'all' ? { inlineSize: `${actualPanelSize}px` } : undefined}\n        >\n          {panelPosition === 'side-start' && wrappedPanelContent}\n          {resizable && display === 'all' && handle}\n          {panelPosition === 'side-end' && wrappedPanelContent}\n        </div>\n        {panelPosition === 'side-start' && wrappedMainContent}\n      </div>\n    );\n  }\n);\n\nexport default InternalPanelLayout;\n"]}